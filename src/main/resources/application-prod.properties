# Production Database Configuration
spring.datasource.url=${POSTGRES_URL:jdbc:postgresql://localhost:5432/stockify}
spring.datasource.username=${POSTGRES_USER:postgres}
spring.datasource.password=${POSTGRES_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver

# Database Connection Pool Configuration (Production)
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:20}
spring.datasource.hikari.minimum-idle=${DB_POOL_MIN_IDLE:5}
spring.datasource.hikari.connection-timeout=${DB_CONNECTION_TIMEOUT:30000}
spring.datasource.hikari.idle-timeout=${DB_IDLE_TIMEOUT:600000}
spring.datasource.hikari.max-lifetime=${DB_MAX_LIFETIME:1800000}
spring.datasource.hikari.leak-detection-threshold=${DB_LEAK_DETECTION:60000}

# Server Configuration
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# JPA/Hibernate Configuration - Override base settings
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true

# Multi-tenant Hibernate Configuration - PostgreSQL Optimized for PRODUCTION
spring.jpa.properties.hibernate.multiTenancy=SCHEMA
spring.jpa.properties.hibernate.tenant_identifier_resolver=dev.oasis.stockify.config.tenant.CurrentTenantIdentifierResolverImpl
spring.jpa.properties.hibernate.multi_tenant_connection_provider=dev.oasis.stockify.config.tenant.PostgreSQLMultiTenantConnectionProvider

# PostgreSQL-specific Physical Naming Strategy (RECOMMENDED FOR PRODUCTION)
spring.jpa.properties.hibernate.physical_naming_strategy=dev.oasis.stockify.config.tenant.PostgreSQLMultiTenantPhysicalNamingStrategy
spring.jpa.properties.hibernate.default_schema=public

# PostgreSQL Performance Optimizations
spring.jpa.properties.hibernate.globally_quoted_identifiers=false
spring.jpa.properties.hibernate.auto_quote_keyword=false
spring.jpa.open-in-view=false
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=true

# Flyway Configuration
spring.flyway.enabled=${SPRING_FLYWAY_ENABLED:true}
spring.flyway.locations=classpath:db/migration
spring.flyway.baseline-on-migrate=${SPRING_FLYWAY_BASELINE_ON_MIGRATE:true}
spring.flyway.validate-on-migrate=${SPRING_FLYWAY_VALIDATE_ON_MIGRATE:false}
spring.flyway.schemas=${FLYWAY_SCHEMAS:public,stockify,acme_corp,global_trade,artisan_crafts,tech_solutions,company1}
spring.flyway.default-schema=public
spring.flyway.create-schemas=true

# Production Logging Configuration
logging.level.root=WARN
logging.level.dev.oasis.stockify=INFO
logging.level.org.springframework.security=WARN
logging.file.name=${LOG_FILE_PATH:logs/stockify-prod.log}
logging.file.max-size=50MB
logging.file.max-history=30
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] [tenant:%X{tenantId}] %-5level %logger{36} - %msg%n

# Production Thymeleaf Configuration
spring.thymeleaf.cache=true

# Email Configuration (Production)
notification.email.enabled=true
spring.mail.host=${MAIL_HOST:smtp.gmail.com}
spring.mail.port=${MAIL_PORT:587}
spring.mail.username=${MAIL_USERNAME:}
spring.mail.password=${MAIL_PASSWORD:}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.ssl.trust=${MAIL_HOST:smtp.gmail.com}

# Security Configuration (Production)
spring.security.require-ssl=${REQUIRE_SSL:false}
server.servlet.session.timeout=${SESSION_TIMEOUT:30m}
server.servlet.session.cookie.secure=${COOKIE_SECURE:false}
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.same-site=strict

# Actuator Configuration for Health Checks 
management.endpoint.health.show-details=when-authorized
management.health.defaults.enabled=true
management.endpoints.web.exposure.include=health,metrics,prometheus
management.endpoints.web.base-path=/actuator
management.endpoint.health.roles=ADMIN
management.security.enabled=true

# Metrics and Monitoring
management.metrics.tags.application=stockify
management.metrics.tags.environment=production
management.metrics.export.prometheus.enabled=true
management.endpoint.metrics.enabled=true
management.endpoint.prometheus.enabled=true

# Performance and Caching
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=1000,expireAfterWrite=30m

# Error Handling (Production)
server.error.whitelabel.enabled=false
server.error.include-stacktrace=never
server.error.include-message=never
